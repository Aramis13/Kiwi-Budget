<template>
  <v-toolbar app>
    <svg x="0px" y="0px"
      width="48" height="48"
      viewBox="0 0 210 210"
      style=" fill:#000000;"><g transform=""><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,210v-210h210v210z" fill="none"></path><g><g id="surface1"><path d="M57.86621,160.81543c-6.20361,-0.75195 -12.91992,-0.54687 -12.91992,-0.54687l-5.33203,-13.4668l6.57959,-26.36963l-21.55029,-4.51172l3.93066,35.1709l7.62207,17.75635c8.63037,8.63037 21.07178,7.72461 21.07178,7.72461c0,-3.3667 -2.59766,-5.94727 -2.59766,-5.94727h12.93701c0,0 -1.89697,-8.86963 -9.74121,-9.80957z" fill="#666666"></path><path d="M158.45703,109.66553c0,0 17.10693,24.52393 21.82373,32.8125c10.47608,18.37158 13.96241,29.63379 15.63721,29.27491c1.53809,-0.3418 2.66602,-4.49463 -8.52783,-29.68506c-11.1084,-25.00244 -16.25244,-38.26416 -16.25244,-38.26416z" fill="#34495e"></path><path d="M105.99121,169.56543c-6.20361,-0.75195 -17.70508,-0.54687 -17.70508,-0.54687l-13.82569,-15.22705l-3.41797,-21.31104l-23.8916,-8.54492l12.56104,32.8125c0.42725,1.14502 1.16211,2.13623 2.11914,2.88818l22.49023,17.94434c8.63037,8.63037 21.07178,7.72461 21.07178,7.72461c0,-3.34961 -2.59766,-5.93018 -2.59766,-5.93018h12.93701c0,0 -1.89697,-8.86963 -9.74121,-9.80957z" fill="#666666"></path><path d="M13.125,94.81445c0,-17.80761 13.77442,-51.06445 54.17481,-51.06445c35.82031,0 56.27685,31.59912 61.77978,31.59912c5.50293,0 10.28809,-4.51172 21.0376,-4.51172c17.14111,0 27.63428,14.11621 27.63428,25.25879c0,12.23633 -9.00634,19.89258 -14.49219,19.89258c-11.2622,0 -15.3125,-4.51172 -21.84082,-4.51172c-5.98145,0 -11.87744,18.01269 -28.65967,18.01269c-21.39648,0 -33.83789,10.18555 -39.22119,22.45606c-11.63818,0 -20.8667,-9.29687 -20.8667,-9.29687c0,0 -39.5459,-9.82666 -39.5459,-47.83447z" fill="#9b59b6"></path><path d="M91.29395,48.68896c21.12305,8.88672 33.66699,26.66016 37.78564,26.66016c5.50293,0 10.28809,-4.51172 21.0376,-4.51172c-12.15088,7.7417 -12.56104,21.94336 -8.69873,40.63965c-5.98145,0 -11.87744,18.01269 -28.65967,18.01269c-21.39648,0 -33.83789,10.18555 -39.22119,22.45606c-1.1792,-47.08252 60.77148,-30.83008 17.75635,-103.25684z" fill="#f1c40f"></path><path d="M166.62598,97.92481c0,2.49511 -2.03369,4.51172 -4.51172,4.51172c-2.49512,0 -4.52881,-2.0166 -4.52881,-4.51172c0,-2.49512 2.03369,-4.51172 4.52881,-4.51172c2.47803,0 4.51172,2.0166 4.51172,4.51172z" fill="#212121"></path></g></g><path d="" fill="none"></path><path d="" fill="none"></path><path d="M105,210c-57.9899,0 -105,-47.0101 -105,-105v0c0,-57.9899 47.0101,-105 105,-105v0c57.9899,0 105,47.0101 105,105v0c0,57.9899 -47.0101,105 -105,105z" fill="none"></path><path d="M105,205.8c-55.6703,0 -100.8,-45.1297 -100.8,-100.8v0c0,-55.6703 45.1297,-100.8 100.8,-100.8h0c55.6703,0 100.8,45.1297 100.8,100.8v0c0,55.6703 -45.1297,100.8 -100.8,100.8z" fill="none"></path><path d="M0,210v-210h210v210z" fill="none"></path><path d="M4.2,205.8v-201.6h201.6v201.6z" fill="none"></path><path d="M105,210c-57.9899,0 -105,-47.0101 -105,-105v0c0,-57.9899 47.0101,-105 105,-105v0c57.9899,0 105,47.0101 105,105v0c0,57.9899 -47.0101,105 -105,105z" fill="none"></path><path d="M105,205.8c-55.6703,0 -100.8,-45.1297 -100.8,-100.8v0c0,-55.6703 45.1297,-100.8 100.8,-100.8h0c55.6703,0 100.8,45.1297 100.8,100.8v0c0,55.6703 -45.1297,100.8 -100.8,100.8z" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path></g></g></svg>
    <v-toolbar-title class="primary--text hidden-xs-only">Kiwi Budget</v-toolbar-title>
    <v-spacer></v-spacer>
    <v-toolbar-items>
      <v-btn flat class="accent--text" to="/records">Records</v-btn>
      <v-btn flat class="accent--text" to="/statistics">Statistics</v-btn>
      <v-btn flat class="accent--text" to="/connections">Connections</v-btn>
    <v-menu offset-y>
      <template v-slot:activator="{ on }">
        <v-btn class="accent--text" flat fab outline small v-on="on">
          <v-icon class="accent--text">person</v-icon>
        </v-btn>
      </template>
      <v-list>
        <v-list-tile @click="ChangeTheme()">
          <v-list-tile-title>Change Theme</v-list-tile-title>
        </v-list-tile>
        <v-list-tile @click="Logout()">
          <v-list-tile-title>Logout</v-list-tile-title>
        </v-list-tile>
      </v-list>
    </v-menu>
    <v-btn flat style="color:#1976d2 !important;" disabled>{{ userName }}</v-btn>
    </v-toolbar-items>
  </v-toolbar>
</template>

<script>
import axios from 'axios'
export default {
  data: () => ({
    theme: 'light',
    userName: localStorage.getItem('portfolioManagerUserName')
  }),
  methods: {
    ChangeTheme () {
      if (this.theme === 'light') {
        this.theme = 'dark'
      } else {
        this.theme = 'light'
      }
      axios.post('/api/configuration/changeTheme', {theme: this.theme}).then(res => {
        if (!res) {
          this.$toasted.show('Failed to change theme. Please try again.', {
            theme: 'bubble',
            position: 'top-right',
            duration: 5000,
            type: 'error',
            icon: 'error'
          })
        } else {
          this.$root.$emit('ThemeChanged', this.theme)
        }
      }).catch(e => {
        this.$toasted.show('Failed to change theme. Please try again.', {
          theme: 'bubble',
          position: 'top-right',
          duration: 5000,
          type: 'error',
          icon: 'error'
        })
      })
    },
    Logout () {
      this.$root.$emit('logedOut')
      this.$cookie.delete('portfolioManagerToken')
      localStorage.removeItem('portfolioManagerUserName')
      this.$router.push({ name: 'login' })
    }
  }
}
</script>
